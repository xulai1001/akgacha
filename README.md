# akgacha
明日方舟 模拟抽卡和蹲饼插件 for [HoshinoBot](https://github.com/Ice-Cirno/HoshinoBot)

Author: 库兰 - NGA romanosovsky
自动更新功能：assassinyk
GitHub与问题反馈: https://github.com/xulai1001/akgacha

更新日志
======
### 2022
- 6.27 尝试改进风控问题，优化了蹲饼和游戏公告查询功能。 
- 6.23 重新整理了更新日志，增加了查询素材的命令范围。提交到Hoshino plugin index.
- 6月  将一图流修改为使用selenium实时获取
- 较早的更新内容：
抽卡模拟部分增加了自动更新功能，作者：assassinyk

从PRTS拉取最新的卡池信息，视PRTS更新进度，可能有1-2天的延迟。

### 2021
- 5.22 更新了联合行动池，和联合行动池不歪的判定。已知问题：发饼机抓不到最新一条微博，可能是微博api的问题。
- 4.29 更新了fes池，优化了发饼排版，可以自动折叠和显示动图了
- 3.18 更新普池，更新R6干员头像
- 3.3 修正一些问题，增加r6卡池测试
- 2.28 增加素材一图流查询
- 2.23 更新干员头像和新普池

使用方法
======
# 抽卡模拟相关
[@Bot 方舟十连] 明日方舟抽卡

[@Bot 方舟来一井] 300抽

[查看方舟卡池] 当前卡池信息

[切换方舟卡池 x] 更改卡池到x，可用查看历史卡池命令列出可用的名字

[查看方舟历史卡池] 查看可抽的所有卡池名（长）

# 抽卡管理命令:
[更新方舟基础数据] 更新角色数据库

[更新方舟卡池] 更新卡池信息

[更新方舟资源] 下载头像包到/res/img/akgacha/，具体进程请在后台查看

# 信息查询命令：
[饼呢 x] 查看方舟官方微博消息

[蹲饼/取消蹲饼] 开启、关闭蹲饼推送

[游戏公告] 查看方舟官方游戏公告

[方舟素材|材料|刷图] 显示ark.yituliu.site的素材效率一图流，实时更新。注意：此功能需要配置chromedriver和selenium

[方舟dps 干员名] 跳转到DPS计算器的指定干员

[专精收益 干员名] 跳转到专精收益计算器的指定干员页面

安装
======
- 将本项目放在hoshino/modules/目录下
- res.zip为头像数据，解压在Hoshino根目录下(头像路径为res/img/akgacha/*.png)

说明
======
- 插件启动时会自动在后台进行蹲饼，但是推送到群需要手动开启（群聊发送"蹲饼"开启）
- 蹲饼的微博ID可以在__init__.py中自行设置，默认为方舟官微和海猫
- 程序内使用的游戏图片，仅用于更好地表现游戏资料，其版权属于 Arknights/上海鹰角网络科技有限公司。其他内容采用知识共享署名-非商业性使用-相同方式共享授权。

已知问题
======
- 如果碰到找不到json文件的问题，尝试调整代码的working_path字符串。这部分还在调整中
- 如果蹲饼报错或者不推送，尝试删除group_banner.json
- 如果报ssl错误，可以尝试升级requests库到最新版本
- 方舟游戏公告功能无法发送消息，之后计划改成selenium截图
- 蹲饼可能会吞消息，可以手动吃饼
